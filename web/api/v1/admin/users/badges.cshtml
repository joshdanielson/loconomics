@using WebMatrix.WebData;
@*
    Admin access to users badges.

    Options:

    - GET /
      List all non removed user badges

    - GET /@userBadgeID
      Get badge record by ID

    - POST /
      Insert or update an user badge

    EXAMPLES {
        "Admin user badges (list and create)": {
            "url": "/api/v1/en-US/admin/users/141",
            "get": {},
            "post": {}
        },
        "Admin user badges (item)": {
            "url": "/api/v1/en-US/admin/users/141/2",
            "get": {},
            "put": {}
        }
    }
*@
@functions{
    public class RestUserProfile : RestWebPage
    {
        public override dynamic Get()
        {
            var userID = this.WebPage.Context.GetRouteValue("userID").AsInt(0);
            if (userID <= 0)
            {
                throw new HttpException(404, "User Not Found");
            }

            var locale = LcRest.Locale.Current;
            if (UrlData.Count == 1 && UrlData[0].IsInt())
            {
                return LcRest.UserBadge.Get(userID, UrlData[0].AsInt(), locale.languageID, locale.countryID);
            }
            else if (UrlData.Count == 0)
            {
                return LcRest.UserBadge.ListAllByUser(userID, locale.languageID, locale.countryID);
            }
            else
            {
                return base.Get();
            }
        }
    }
}
@{
    Response.RestRequiresUser(LcData.UserInfo.UserType.Admin);
    new RestUserProfile().JsonResponse(this);
}
