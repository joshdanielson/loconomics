<form id="referProfessionalForm" class="LeadGeneration" aria-describedby="referProfessionalFormInstructions">
    <fieldset id="referProfessionalsForm-StepOne" class="refer-step"
        data-bind="visible: isAtStepOne() && !isAnonymous(), if: isAtStepOne">
        <div class="col-xs-12">
            <legend>Know a professional?</legend>
            <p class="LeadGeneration-loggedInMessage">Know a service professional in your community who could benefit from the power of Loconomics?</p>
            <button type="button" class="btn btn-secondary btn-block btn-lg LeadGeneration-buttonLarge" data-bind="disable: isLocked, click: goStepTwo">Introduce us</button>
        </div>
    </fieldset>
    <fieldset id="referProfessionalsForm-StepOne" class="refer-step"
        data-bind="visible: isAtStepOne() && isAnonymous(), if: isAtStepOne, css: { 'has-error': errorMessage }">
        <div class="col-xs-12">
            <legend>Make an introduction</legend>
            <label for="referrerEmailAddress">Your email address</label>
        </div>
        <div class="col-xs-9 col-sm-10 col-md-9">
            <div class="form-group" data-bind="css: { 'has-feedback': isEmailValid }">
                <input class="form-control"
                    id="referrerEmailAddress"
                    type="email"
                    placeholder="example@address.com"
                    data-bind="
                        textInput: email,
                        popover: { content: errorMessage, trigger: 'focus', container: 'body', placement: 'top' },
                        disable: isLocked,
                        css: { 'is-valid': isEmailValid }
                    " />
                <i class="form-control-feedback text-success ion-android-done"
                    data-bind="visible: isEmailValid"
                    aria-hidden="true"></i>
            </div>
        </div>
        <div class="col-xs-3 col-sm-2 col-md-3 col-lg-2">
            <button type="submit" class="btn btn-secondary btn-block LeadGeneration-buttonSmall" data-bind="disable: isLocked, click: saveStepOne" aria-label="Continue to step two">
                <icon-dec data-bind="visible: !isSaving()" params="icon: 'ion-arrow-right-c'"></icon-dec>
                <icon-dec data-bind="visible: isSaving()" params="icon: 'ion-android-sync fa-spin'"></icon-dec>
            </button>
        </div>
        <div class="checkbox-inline col-xs-10 col-offset-1">
            <input id="isServiceProfessional" type="checkbox" data-bind="checked: isServiceProfessional, disable: isLocked">
            <label for="isServiceProfessional">I also offer local services</label>
        </div>
        <p id="referProfessionalFormInstructions" class="help-block col-xs-12">Know a service professional in your community who could benefit from the power of Loconomics?</p>
    </fieldset>
    <fieldset id="referProfessionalsForm-StepTwo" class="refer-step"
        data-bind="visible: isAtStepTwo, if: isAtStepTwo, autofocus: isAtStepTwo, css: { 'has-error': errorMessage }">
        <legend>Your name</legend>
        <label for="referrerFirstName">Your first name</label>
        <div class="form-group">
            <input class="form-control"
                id="referrerFirstName"
                type="text"
                data-bind="
                    textInput: firstName,
                    disable: isLocked
                " />
        </div>
        <label for="referrerLastName">Your last name</label>
        <div class="form-group">
            <input class="form-control"
                id="referrerLastName"
                type="text"
                data-bind="
                    textInput: lastName,
                    disable: isLocked
                " />
        </div>
        <button type="submit" class="btn btn-secondary btn-block btn-lg LeadGeneration-buttonLarge" data-bind="disable: isLocked, click: saveStepTwo">
            <span data-bind="visible: !isSaving()">Continue</span>
            <span data-bind="visible: isSaving()">Saving</span>
        </button>
        <p class="help-block">We'll need your name so we can say who's referring them.</p>
    </fieldset>
    <fieldset id="referProfessionalsForm-StepThree" class="refer-step"
        data-bind="visible: isAtStepThree, if: isAtStepThree, autofocus: isAtStepThree, css: { 'has-error': errorMessage }">
        <legend data-bind="visible: !isDone()">Who's the service professional?</legend>
        <legend data-bind="visible: isDone, autofocus: isDone">You're amazing â€“ thanks! Know another?</legend>
        <label for="referredFirstName">Their first name</label>
        <div class="form-group">
            <input class="form-control"
                id="referredFirstName"
                type="text"
                data-bind="
                    textInput: firstName,
                    disable: isLocked
                " />
        </div>
        <div class="form-group has-feedback">
            <label for="referredLastName">Their last name</label>
            <div class="form-group">
                <input class="form-control"
                    id="referredLastName"
                    type="text"
                    data-bind="
                        textInput: lastName,
                        disable: isLocked
                    " />
            </div>
        </div>
        <div class="form-group has-feedback">
            <label for="referredLastName">Their email address</label>
            <div class="form-group" data-bind="css: { 'has-feedback': isEmailValid }">
                <input class="form-control"
                    id="referredEmailAddress"
                    type="email"
                    placeholder="example@address.com"
                    data-bind="
                        textInput: email,
                        popover: { content: errorMessage, trigger: 'focus', container: 'body', placement: 'top' },
                        disable: isLocked,
                        css: { 'is-valid': isEmailValid }
                    " />
                <i class="form-control-feedback text-success ion-android-done"
                    data-bind="visible: isEmailValid"
                    aria-hidden="true"></i>
            </div>
        </div>
        <div class="form-group has-feedback">
            <label for="referredPhoneNumber">Their phone number</label>
            <div class="form-group">
                <input class="form-control"
                    id="referredPhoneNumber"
                    type="tel"
                    data-bind="
                        textInput: phone,
                        disable: isLocked
                    " />
            </div>
        </div>
        <button type="submit" class="btn btn-secondary btn-block btn-lg LeadGeneration-buttonLarge" data-bind="disable: isLocked, click: saveStepThree">Make introduction
        </button>
        <p class="help-block">Fear not, we will not spam.</p>
    </fieldset>
</form>